{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <title>MisiÃ³n Emprende UDD â€” Elige la temÃ¡tica</title>
  <link rel="stylesheet" href="{% static 'css/estilo_tematicas.css' %}">
</head>
<body>
  <main class="selector-container" role="main" aria-labelledby="page-title">
    <header class="header">
      <h1 id="page-title">Elige la temÃ¡tica del desafÃ­o</h1>
      <p class="subtitle">Selecciona una categorÃ­a para continuar. Cada bloque explica de quÃ© trata.</p>
    </header>

    <section class="themes-grid" aria-label="TemÃ¡ticas disponibles">
      <!-- Salud -->
      <article class="theme-card" tabindex="-1"
               data-slug="salud"
               data-url="{% url 'desafios' %}">
        <div class="thumb">
          <img src="{% static 'images/tema_salud.png' %}" alt="Icono de salud">
        </div>
        <div class="content">
          <h2 class="title">Salud</h2>
          <div class="chips">
            <span class="chip">ğŸ«¶ EmpatÃ­a</span>
            <span class="chip">ğŸ’¡ Innovar</span>
            <span class="chip">ğŸ’ª Bienestar</span>
          </div>
          <p class="desc">Mejora hÃ¡bitos y bienestar con soluciones prÃ¡cticas.</p>
        </div>
        <div class="actions">
          <button class="btn select" type="button" onclick="guardarTema('salud')">Elegir</button>
        </div>
      </article>

      <!-- Sustentabilidad -->
      <article class="theme-card" tabindex="-1"
               data-slug="sustentabilidad"
               data-url="{% url 'desafios' %}">
        <div class="thumb">
          <img src="{% static 'images/tema_sustentabilidad.png' %}" alt="Icono de sustentabilidad">
        </div>
        <div class="content">
          <h2 class="title">Sustentabilidad</h2>
          <div class="chips">
            <span class="chip">ğŸŒ± Ambiental</span>
            <span class="chip">â™»ï¸ Reciclaje</span>
            <span class="chip">âš™ï¸ Creativo</span>
          </div>
          <p class="desc">Impacto ambiental positivo con ideas circulares.</p>
        </div>
        <div class="actions">
          <button class="btn select" type="button" onclick="guardarTema('sustentabilidad')">Elegir</button>
        </div>
      </article>

      <!-- EducaciÃ³n -->
      <article class="theme-card" tabindex="-1"
               data-slug="educacion"
               data-url="{% url 'desafios' %}">
        <div class="thumb">
          <img src="{% static 'images/tema_educacion.png' %}" alt="Icono de educaciÃ³n">
        </div>
        <div class="content">
          <h2 class="title">EducaciÃ³n</h2>
          <div class="chips">
            <span class="chip">ğŸ—£ï¸ Comunicar</span>
            <span class="chip">ğŸ“ Liderazgo</span>
            <span class="chip">ğŸ’­ Ideas</span>
          </div>
          <p class="desc">Aprendizaje inclusivo con propuestas innovadoras.</p>
        </div>
        <div class="actions">
          <button class="btn select" type="button" onclick="guardarTema('educacion')">Elegir</button>
        </div>
      </article>
    </section>

    <footer class="footer-actions">
      <button id="btnContinuar" class="btn primary" type="button" disabled>
        Comenzar desafÃ­o
      </button>
    </footer>
  </main>

  <!-- Tu JS de selecciÃ³n (solo botÃ³n â€œElegirâ€, sin navegar) -->
  <script src="{% static 'js/tematica.js' %}" defer></script>

  <!-- CTA que redirige con ?tema= -->
  <script>
    (function () {
      const cta = document.getElementById('btnContinuar');

      function updateCTAState() {
        const tema = localStorage.getItem('temaSeleccionado');
        cta.disabled = !tema;
      }

      // RedirecciÃ³n al pulsar â€œComenzar desafÃ­oâ€
      cta.addEventListener('click', function () {
        const tema = localStorage.getItem('temaSeleccionado');
        if (!tema) return alert('Selecciona una temÃ¡tica antes de continuar.');
        window.location.href = "{% url 'desafios' %}?tema=" + encodeURIComponent(tema);
      });

      // Estado inicial del CTA (sin preseleccionar)
      try { updateCTAState(); } catch (e) {}

      // Si cambias la selecciÃ³n en otra pestaÃ±a/ventana
      window.addEventListener('storage', updateCTAState);
    })();
  </script>
</body>
</html>
